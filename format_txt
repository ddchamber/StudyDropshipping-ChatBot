def format_text_for_chunking(raw_text):
    lines = raw_text.splitlines()
    output_lines = []
    for line in lines:
        stripped = line.strip()

        # Treat short title-like lines or ending in ":" as headers
        if stripped and (len(stripped.split()) <= 10 or stripped.endswith(":")):
            output_lines.append(stripped)
        elif stripped == "":
            output_lines.append("")  # Preserve paragraph breaks
        else:
            output_lines.append("    " + stripped)  # Indent paragraph lines
    return "\n".join(output_lines)

# Example usage
with open("/Users/williamkapner/Downloads/CHAPTER 9 - TikTok Ads.txt", "r", encoding="utf-8") as f:
    raw_input = f.read()

formatted_text = format_text_for_chunking(raw_input)

# Save the properly formatted text so it works with your original pipeline
with open("/Users/williamkapner/Downloads/CHAPTER 9 - TikTok Ads.txt", "w", encoding="utf-8") as f:
    f.write(formatted_text)
